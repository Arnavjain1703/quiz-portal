{% extends 'admin/base_for_admin.html' %}

{% load static %} 


{% block head %}
   <link rel="stylesheet" href="{% static 'core/css/edittestname.css' %}">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script>
        console.log(1);
        $(document).ready(function(){
            console.log(2);
            $(".change").on('click', function(event) {
                console.log(3);
                var imgid;
                var test;
                var dur;
                imgid = $(this).attr("cat_data");
                console.log(imgid);
                test = $('#test' + imgid).val();
                dur = $('#dur' + imgid).val();
                console.log(test);
                console.log(dur);
                $.ajax({
                    url: '{% url 'Edit_Test' %}',
                    data: {
                        'imgid': imgid, 
                        'test': test,
                        'dur':dur,
                        },
                    dataType: 'json',
                    success: function (data) {
                        console.log(5)
                    }
                });
            })
        });
    </script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.css" rel="stylesheet"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert-dev.min.js"></script>
{% endblock %}

{% block content %}
<main class="container">
<div class="test-list">
    <h3 class="heading">Test List</h3>
    <table class="table table-head">
        <thead>
            <tr>
                <th>#</td>
                <th>Test Name</td>
                <th>Maximum Marks</td>
                <th>Status</td>
                <th>Action</td>
            </tr>
        </thead>
    </table>
    <ol>
        {% for test in tests %}
            <li>
                <table class="table table-hover">
                    <tbody>
                        <tr>
                            <td>
                                <input class="form-control" id="test{{test.pk}}" type="text" name="category" value={{ test.test_name }}>
                            </td>
                            <td>
                                <input class="form-control" id="dur{{test.pk}}" value={{ test.duration }}>
                            </td>
                            <td>
                                {% if test.on_or_off == True %}
                                <p>Started</p>
                                {% else %}
                                <p>Not started yet</p>
                                {% endif %}
                            </td>
                            <td>
                                <a href="{% url "toggle" test.pk %}">
                                    <button type="button" class="btn btn-raised btn-warning">Toggle test status</button>
                                </a>
                                <a>
                                    <button class="change btn btn-raised btn-primary" cat_data="{{test.pk}}">Save after editing</button>
                                </a>
{#                                <a href="{% url "Delete_Test" test.pk %}">#}
                                    <button type="button" class="btn btn-raised btn-danger" onclick="JSalert()">Delete Test</button>
                                        <script type="text/javascript">
                                            function JSalert(){
                                                swal({   title: "Are you sure you want to proceed?",
                                                type: "warning",
                                             showCancelButton: true,
                                           confirmButtonColor: "#DD6B55",
                                          confirmButtonText: "Yes",
                                        cancelButtonText: "Cancel",
                                         closeOnConfirm: false,
                                        closeOnCancel: false },
                                         function(isConfirm){
                                         if (isConfirm)
                                          {
                                              window.location.href = "{% url 'Delete_Test' test.pk %}";
                                            }
                                          else {
                                             swal.close();
                                            } });
                                    }
                                    </script>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
        {% empty %}
            <p>No Test available.</p>
        {% endfor %}
    </ol>
</div>
</main>
{% endblock %}
